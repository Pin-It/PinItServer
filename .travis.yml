language: python
services:
- postgresql
python:
- '3.6'

# install dependencies
before_install:
- pip install pipenv
install:
- pipenv install

# testing
before_script:
- psql -c 'CREATE DATABASE test_db;' -U postgres
env:
- DATABASE_URL=postgres://postgres@localhost/test_db
script:
- python manage.py test

# deploy to heroku
deploy:
  provider: heroku
  api_key:
    secure: s44wa5FYHGMh+r9i/DSXObhvweJMOuJqZC1vQFv4OTud2gSGgIT+Ji03LC3jrWnnaHgC9/8HRFAhoPKiXRpqENqOLOrJBAHG3Fv8m7317M+F8SZ11r/osTdV9tRjKPnLMokarXzjnFqzbWkc0O7cFfX3lTZN2rvW+gt2jDPTgKfuefhkxp4uR5EplVCJIv1RgTfL2wXky1y5u2uCydw93DXDXlO1Cr73DBZQ93VBmIyr9rfPalPPg4tqrkV/UGoDc6m6kQoiKYNUVf+8PI1N0ogiXFNHLqj6rScWiaxx8F8biXX/sFQCGY0vlVSOWGP0lC/KemshLSoJHflVmUmdW6cqlqGo334iuLGGmqB/dmD3u8bp/gcjv1nbkt2Y1rYm+ektdJzPQqWpzZeFsEhrFCs6IILMWvAarG9I0kNChWADWtPG/Ut8U/4cwhm+9dt3P4geAXoLeabVwvi+mMrUZp7+KeypI397SyIyXfVaE4WstfYPNvKEKuSeNkzUudVK1dzQhw154rdfIHEu6jTYk0fppLFumqsR+25NI/MAnKj78TDav9Dd4nOn0xOswCCiltGsLx/HFAJru3K6K489CBrtJIBeLJTBjiVhT/eiOCJCBeF//uWFsStoe8m6Kmf9qA95WFcXBZISIgKsH58HvsICZBDiYViB7EJ1W8Qr3Xs=
  app: pin-it-app
  on:
    repo: Pin-It/PinItServer
